<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>장바구니</title>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="testStyle.css">

  <style>
    * {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

input {
  width: 30px;
  height: 30px;
}

p {
  margin: 0;
}

h4 {
  margin: 5px 0 0 5px;
}

img {
  border-radius: 10px;
  margin: 5px 0;
}

span {
  margin: 0 5px;
}

body {
  margin: 0 auto;
  padding: 0;
  display: flex;
  flex-direction: column;
}
main{
  display:flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 20px;
}

section {
  display: flex;
  width: 1000px;
  flex-direction: column;
  align-items: center;
  margin: 0 auto;
}

.basket {
  margin: 30px 0;
}

.aaa {
  width: 100%;
  max-width: 1000px;
  display: flex;
}

.detail {
  width: 100%;
  max-width: 720px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.item-info {
  display: flex;
  align-items: center;
}

.item-detail {
  display: flex;
  justify-content: space-between;
  border: 1px solid rgba(165, 165, 165, 0.3);
  border-radius: 10px;
  padding: 10px;
}

.choose-all {
  width: 100%;
  max-width: 700px;
  display: flex;
  align-items: center;
  padding: 10px;
  background-color: #f8f8f8;
  margin-bottom: 15px;
}

.delete {
  margin-left: auto;
}

.delete button {
  background-color: #ff4d4d;
  color: white;
  border: none;
  padding: 5px 15px;
  margin-left: auto;
  cursor: pointer;
  font-size: 14px;
  border-radius: 4px;
}

.delete button:hover {
  background-color: #e60000;
}

.item-name {
  flex: 1;
  margin-left: 5px;
}

.item-option {
  display: flex;
  align-items: center;
}

.option {
  display: flex;
  align-items: center;
  gap: 10px;
}

.option-delete {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-left: 20px;
}

.option-delete button {
  border: none;
  background-color: rgb(255, 255, 255);
}

.order {
  width: 100%;
  max-width: 250px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-left: auto;
}

.price, .order-now {
  height: 70px;
  background-color: rgba(202, 202, 202, 0.4);
  display: flex;
  justify-content: space-between;
  align-items: center;
  border: 1px solid rgba(59, 59, 59, 0.3);
}

.item-name {
  width: 400px;
  display: flex;
  padding: 0px;
  margin: 0 auto;
  flex-direction: column;
}
.how-much{
  font-size: 12px;
  color: #555;
  padding: 5px 0 0 7px;
}

.item-option {
  width: 265px;
  display: flex;
  justify-content: flex-end;
}

.option {
  align-items: center;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 80px;
}
.option button{
  background-color: rgb(255, 255, 255);
  border-style: none;
  cursor: pointer;
}

.option-delete {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-left: 20px;
  width: 80px;
  height: 80px;
  position: relative;
}

.option-delete button {
  position: absolute;
  top: 3px;
  right: 5px;
  border-style: none;
  background-color: rgb(255, 255, 255);
}

.order {
  width: 250px;
  margin-left: 30px;
}

.price {
  height: 70px;
  background-color: rgba(202, 202, 202, 0.4);
  display: flex;
  justify-content: space-between;
  border: 1px solid rgba(59, 59, 59, 0.3)
}

.oredernow {
  height: 70px;
  background-color: rgba(202, 202, 202, 0.4);
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(59, 59, 59, 0.3)
}
.buy{
  width: 100%;
  height: 40px;
  background-color: #007bff;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
  border: 1px solid #000;
}
  </style>
</head>



<body>
  <header>
    <div id="header-placeholder"></div>
  </header>
  <!-- 동적로딩 -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      function loadHTML(url, elementId) {
        fetch(url)
          .then(response => response.text())
          .then(data => {
            document.getElementById(elementId).innerHTML = data;
          })
          .catch(error => console.error('Error loading the HTML:', error));
      }

      loadHTML('header.html', 'header-placeholder');
      loadHTML('footer.html', 'footer-placeholder');
    });
  </script>

  <main>
    <section>
      <div class="basket">
        <h2>장바구니</h2>
      </div>
      <div class="item">
        <div class="choose-all">
          <div>
            <input type="checkbox" id="check-all">
          </div>
          <div class="unchoose">
            <p>선택해제</p>
          </div>
          <div class="delete">
            <button>선택삭제</button>
          </div>
        </div>
        <div class="aaa"> <!--이름 아직 안정함-->
          <div class="detail">
            <div class="item-detail">
              <div class="item-info">
                <input class="item-check" class="item" type="checkbox">
                <img src="https://via.placeholder.com/80x80">
                <div class="item-name">
                  <h4>사세 리얼찹라이드손살치킨1kg</h4>
                  <div class="how-much">1원</div>
                </div>
              </div>
              <div class="item-option">
                <div class="option">
                  <button class="dash" data-id="1">
                    <i class="bi bi-dash-lg"></i>
                  </button>
                  <span class="result" data-id="1">1</span>
                  <button class="plus" data-id="1">
                    <i class="bi bi-plus-lg"></i>
                  </button>
                </div>
                <div class="option-delete">
                  <button type="button" class="X">X</button>
                  <span class="won" data-id="1">1원</span>
                </div>
              </div>
            </div>
            <div class="item-detail">
              <div class="item-info">
                <input class="item-check" class="item" type="checkbox">
                <img src="https://via.placeholder.com/80x80">
                <div class="item-name">
                  <h4>사세 리얼찹라이드손살치킨2kg</h4>
                  <div class="how-much">11원</div>
                </div>
              </div>
              <div class="item-option">
                <div class="option">
                  <button class="dash" data-id="2"><i class="bi bi-dash-lg"></i></button>
                  <span class="result" data-id="2">1</span>
                  <button class="plus" data-id="2"><i class="bi bi-plus-lg"></i></button>
                </div>
                <div class="option-delete">
                  <button type="button" class="X">X</button>
                  <span class="won" data-id="2">11원</span>
                </div>
              </div>
            </div>
            <div class="item-detail">
              <div class="item-info">
                <input class="item-check" class="item" type="checkbox">
                <img src="https://via.placeholder.com/80x80">
                <div class="item-name">
                  <h4>사세 리얼찹라이드손살치킨3kg</h4>
                  <div class="how-much">111원</div>

                </div>
              </div>
              <div class="item-option">
                <div class="option">
                  <button class="dash" data-id="3"><i class="bi bi-dash-lg"></i></button>
                  <span class="result" data-id="3">1</span>
                  <button class="plus" data-id="3"><i class="bi bi-plus-lg"></i></button>
                </div>
                <div class="option-delete">
                  <button type="button" class="X">X</button>
                  <span class="won" data-id="3">111원</span>
                </div>
              </div>
            </div>
            <div class="item-detail">
              <div class="item-info">
                <input class="item-check" class="item" type="checkbox">
                <img src="https://via.placeholder.com/80x80">
                <div class="item-name">
                  <h4>사세 리얼찹라이드손살치킨4kg</h4>
                  <div class="how-much">1,111원</div>
                </div>
              </div>
              <div class="item-option">
                <div class="option">
                  <button class="dash" data-id="4">
                    <i class="bi bi-dash-lg"></i>
                  </button>
                  <span class="result" data-id="4">1</span>
                  <button class="plus" data-id="4">
                    <i class="bi bi-plus-lg"></i>
                  </button>
                </div>
                <div class="option-delete">
                  <button type="button" class="X">X</button>
                  <span class="won" data-id="4">1,111원</span>
                </div>
              </div>
            </div>
            <div class="item-detail">
              <div class="item-info">
                <input class="item-check" class="item" type="checkbox">
                <img src="https://via.placeholder.com/80x80">
                <div class="item-name">
                  <h4>사세 리얼찹라이드손살치킨5kg</h4>
                  <div class="how-much">11,111원</div>
                </div>
              </div>
              <div class="item-option">
                <div class="option">
                  <button class="dash" data-id="5">
                    <i class="bi bi-dash-lg"></i>
                  </button>
                  <span class="result" data-id="5">1</span>

                  <button class="plus" data-id="5">
                    <i class="bi bi-plus-lg"></i>
                  </button>
                </div>
                <div class="option-delete">
                  <button type="button" class="X">X</button>
                  <span class="won" data-id="5">11,111원</span>
                </div>
              </div>
            </div>
          </div>
          <div class="order">
            <div class="price">
              <div>
                <p>총 선택상품금액</p>
              </div>
              <div>
                <span id="total-price"> 0원</span>
              </div>
            </div>
            <div class="price">
              <div>
                <p>예상 주문 금액</p>
              </div>
              <div>
                <span id="estimated-price"> 0원</span>
              </div>
            </div>
            <div class="oreder-now">
              <button class="buy" onclick="buy()" id="buy">총 0건 주문하기 (0원)</button>
            </div>
          </div>

        </div>
      </div>
    </section>
  </main>
  <script src="script.js"></script>
  <footer>
    <div id="footer-placeholder"></div>
  </footer>
    <script src="test.js"></script>
</body>

<script>
    $(document).ready(function () {
  // 초기 가격 정보 설정 (data-id에 따라 다르게 설정)
  const initialPrices = {
    1: 1,    // id=1의 초기 가격
    2: 11,   // id=2의 초기 가격
    3: 111,   // id=3의 초기 가격
    4: 1111,
    5: 11111
  };

  // 수량 증가 버튼 클릭 시
  $('.plus').on('click', function () {
    let id = $(this).data('id');
    let $result = $(`.result[data-id="${id}"]`);
    $result.text(parseInt($result.text()) + 1);
    updateItemPrice(id);
    updateTotalPrice();
  });

  // 수량 감소 버튼 클릭 시
  $('.dash').on('click', function () {
    let id = $(this).data('id');
    let $result = $(`.result[data-id="${id}"]`);
    let newValue = parseInt($result.text()) - 1;
    if (newValue > 0) {
      $result.text(newValue);
      updateItemPrice(id);
      updateTotalPrice();
    }
  });

  // 개별 항목의 가격을 업데이트
  function updateItemPrice(id) {
    let quantity = parseInt($(`.result[data-id="${id}"]`).text());
    let basePrice = initialPrices[id]; // 초기 가격 가져오기
    let totalItemPrice = basePrice * quantity;

    // 업데이트된 가격을 해당 항목에 반영
    $(`.won[data-id="${id}"]`).text(totalItemPrice.toLocaleString() + '원');
  }

  // 전체 가격을 업데이트하는 함수
  function updateTotalPrice() {
    let totalPrice = 0;

    $('.item-detail').each(function () {
      let $item = $(this);
      if ($item.find('.item-check').prop('checked')) {
        let priceText = $item.find('.won').text().replace(/,/g, '').replace('원', '');
        totalPrice += parseInt(priceText);
      }
    });

    // 총 선택상품금액 업데이트
    $('#total-price').first().text(totalPrice.toLocaleString() + '원');

    // 예상 주문 금액 계산 (예상 주문 금액을 계산하려면 추가적인 비율을 적용할 수 있습니다)
    let estimatedPrice = totalPrice * 1.0; // 예시로 1.0을 적용, 필요에 따라 조정
    $('#estimated-price').last().text(estimatedPrice.toLocaleString() + '원');

    // 총 1건 주문하기 버튼의 텍스트 업데이트
    $('.oreder-now .buy').text(`총 ${$('.item-check:checked').length}건 주문하기 (${estimatedPrice.toLocaleString()}원)`);
  }

  // 전체 선택 체크박스 클릭 시
  $('#check-all').on('change', function () {
    let isChecked = $(this).prop('checked');
    $('.item-check').prop('checked', isChecked);
    updateUncheckButton();
    updateTotalPrice();
  });

  // 개별 항목 체크박스 클릭 시
  $('.item-check').on('change', function () {
    updateCheckAll();
    updateUncheckButton();
    updateTotalPrice();
  });

  // 선택 해제 버튼 클릭 시
  $('#uncheck-button').on('click', function () {
    $('#check-all').prop('checked', false);
    $('.item-check').prop('checked', false);
    updateUncheckButton();
    updateTotalPrice();
  });

  // 선택 해제 버튼 업데이트
  function updateUncheckButton() {
    let checkedCount = $('.item-check:checked').length;
    let totalCount = $('.item-check').length;
    $('#uncheck-button').toggleClass('disabled', checkedCount === 0);
  }

  // 전체 선택 체크박스 업데이트
  function updateCheckAll() {
    let totalCount = $('.item-check').length;
    let checkedCount = $('.item-check:checked').length;
    $('#check-all').prop('checked', totalCount === checkedCount);
  }

  // 선택 삭제 버튼 클릭 시
  $('.delete button').on('click', function () {
    if (confirm("삭제하시겠습니까?")) {
      $('.item-check:checked').closest('.item-detail').remove();
      updateCheckAll();
      updateTotalPrice();
    }
  });

  // X 버튼 클릭 시
  $('.X').on('click', function () {
    if (confirm("삭제하시겠습니까?")) {
      $(this).closest('.item-detail').remove();
      updateCheckAll();
      updateTotalPrice();
    }
  });

  // 구매 완료 버튼 이벤트
  $('#buy').click(function () {
    if (confirm("구매 하시겠습니까?")) {
      alert("구매가 완료되었습니다.");
    }
  });
</script>


</html>